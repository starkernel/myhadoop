Subject: [PATCH] fixed： ban掉打包限制
---
Index: ambari-agent/pom.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ambari-agent/pom.xml b/ambari-agent/pom.xml
--- a/ambari-agent/pom.xml	(revision 78c8d5d264673c2e8c02d45eedc0d26ae3c3d4b5)
+++ b/ambari-agent/pom.xml	(date 1749122835993)
@@ -382,6 +382,15 @@
           <description>Maven Recipe: RPM Package.</description>
           <defineStatements>
             <defineStatement>__python 3</defineStatement>
+              <!-- 屏蔽依赖分析，防止 requires/provides 误报 -->
+              <defineStatement>__requires_exclude .*</defineStatement>
+              <defineStatement>__provides_exclude .*</defineStatement>
+              <!-- 禁止生成 debuginfo 包，避免冗余 rpm -->
+              <defineStatement>debug_package %{nil}</defineStatement>
+              <!-- 禁止 rpm 安装后自动脚本、jar repack -->
+              <defineStatement>__os_install_post %{nil}</defineStatement>
+              <defineStatement>__jar_repack %{nil}</defineStatement>
+              <defineStatement>__spec_install_post %{nil}</defineStatement>
           </defineStatements>
           <requires>
             <require>${rpm.dependency.list}</require>
Index: ambari-server/pom.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ambari-server/pom.xml b/ambari-server/pom.xml
--- a/ambari-server/pom.xml	(revision 78c8d5d264673c2e8c02d45eedc0d26ae3c3d4b5)
+++ b/ambari-server/pom.xml	(date 1749122836013)
@@ -584,6 +584,15 @@
           <defineStatements>
              <defineStatement>__python 3</defineStatement>
              <defineStatement>__brp_mangle_shebangs %{nil}</defineStatement>
+            <!-- 屏蔽依赖分析，防止 requires/provides 误报 -->
+            <defineStatement>__requires_exclude .*</defineStatement>
+            <defineStatement>__provides_exclude .*</defineStatement>
+            <!-- 禁止生成 debuginfo 包，避免冗余 rpm -->
+            <defineStatement>debug_package %{nil}</defineStatement>
+            <!-- 禁止 rpm 安装后自动脚本、jar repack -->
+            <defineStatement>__os_install_post %{nil}</defineStatement>
+            <defineStatement>__jar_repack %{nil}</defineStatement>
+            <defineStatement>__spec_install_post %{nil}</defineStatement>
           </defineStatements>
           <autoRequires>no</autoRequires>
           <prefix>/</prefix>
Index: ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/YARN/configuration/yarn-site.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/YARN/configuration/yarn-site.xml b/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/YARN/configuration/yarn-site.xml
--- a/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/YARN/configuration/yarn-site.xml	(revision 78c8d5d264673c2e8c02d45eedc0d26ae3c3d4b5)
+++ b/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/YARN/configuration/yarn-site.xml	(date 1749028034605)
@@ -148,7 +148,7 @@
   </property>
   <property>
     <name>yarn.application.classpath</name>
-    <value>{{hadoop_conf_dir}},{{hadoop_home}}/*,{{hadoop_home}}/lib/*,{{hadoop_hdfs_home}}/*,{{hadoop_hdfs_home}}/lib/*,{{hadoop_yarn_home}}/*,{{hadoop_yarn_home}}/lib/*</value>
+    <value>{{hadoop_conf_dir}},{{hadoop_home}}/*,{{hadoop_home}}/lib/*,{{hadoop_hdfs_home}}/*,{{hadoop_hdfs_home}}/lib/*,{{hadoop_yarn_home}}/*,{{hadoop_yarn_home}}/lib/*,{{hadoop_mapred_home}}/*,{{hadoop_mapred_home}}/lib/*</value>
     <description>Classpath for typical applications.</description>
     <on-ambari-upgrade add="true"/>
   </property>
