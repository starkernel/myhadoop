Subject: [PATCH] feature: 支持ubuntu22涵盖zk和kafka
---
Index: ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/repos/repoinfo.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/repos/repoinfo.xml b/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/repos/repoinfo.xml
--- a/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/repos/repoinfo.xml	(revision f85547ff162dec0ea8c5d1c0fe14ec36621c06bc)
+++ b/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/repos/repoinfo.xml	(date 1752721408885)
@@ -30,4 +30,11 @@
       <reponame>bigtop</reponame>
     </repo>
   </os>
+  <os family="ubuntu22">
+    <repo>
+      <baseurl>http://your-repo/</baseurl>
+      <repoid>BIGTOP-3.2.0</repoid>
+      <reponame>bigtop</reponame>
+    </repo>
+  </os>
 </reposinfo>
Index: ambari-agent/src/main/package/dependencies.properties
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>ISO-8859-1
===================================================================
diff --git a/ambari-agent/src/main/package/dependencies.properties b/ambari-agent/src/main/package/dependencies.properties
--- a/ambari-agent/src/main/package/dependencies.properties	(revision f85547ff162dec0ea8c5d1c0fe14ec36621c06bc)
+++ b/ambari-agent/src/main/package/dependencies.properties	(date 1752717355400)
@@ -29,4 +29,4 @@
 # however should be encouraged manually in pom.xml.

 rpm.dependency.list=openssl,\nRequires: python3-rpm,\nRequires: zlib,\nRequires: net-tools,\nRequires: python3-distro
-deb.dependency.list=openssl, net-tools, python (>= 2.6)
+deb.dependency.list=openssl, net-tools, python3
Index: ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/configuration/cluster-env.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/configuration/cluster-env.xml b/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/configuration/cluster-env.xml
--- a/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/configuration/cluster-env.xml	(revision f85547ff162dec0ea8c5d1c0fe14ec36621c06bc)
+++ b/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/configuration/cluster-env.xml	(date 1752742155191)
@@ -162,7 +162,8 @@
     </property>
     <property>
         <name>repo_ubuntu_template</name>
-        <value>{{package_type}} {{base_url}} {{components}}</value>
+<!--        <value>{{package_type}} {{base_url}} {{components}}</value>-->
+        <value>{{package_type}} [trusted=yes] {{base_url}} ./</value>
         <description>Template of repositories for ubuntu.</description>
         <on-ambari-upgrade add="true"/>
     </property>
Index: ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/KAFKA/metainfo.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/KAFKA/metainfo.xml b/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/KAFKA/metainfo.xml
--- a/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/KAFKA/metainfo.xml	(revision f85547ff162dec0ea8c5d1c0fe14ec36621c06bc)
+++ b/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/KAFKA/metainfo.xml	(date 1752742220157)
@@ -97,7 +97,7 @@
                     </packages>
                 </osSpecific>
                 <osSpecific>
-                    <osFamily>debian7,debian9,ubuntu12,ubuntu14,ubuntu16,ubuntu18</osFamily>
+                    <osFamily>ubuntu22</osFamily>
                     <packages>
                         <package>
                             <name>kafka-${stack_version}</name>
Index: ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/ZOOKEEPER/metainfo.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/ZOOKEEPER/metainfo.xml b/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/ZOOKEEPER/metainfo.xml
--- a/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/ZOOKEEPER/metainfo.xml	(revision f85547ff162dec0ea8c5d1c0fe14ec36621c06bc)
+++ b/ambari-server/src/main/resources/stacks/BIGTOP/3.2.0/services/ZOOKEEPER/metainfo.xml	(date 1752739675970)
@@ -86,6 +86,14 @@
             </package>
           </packages>
         </osSpecific>
+        <osSpecific>
+          <osFamily>ubuntu22</osFamily>
+          <packages>
+            <package>
+              <name>zookeeper-${stack_version}</name>
+            </package>
+          </packages>
+        </osSpecific>
       </osSpecifics>

       <commandScript>
